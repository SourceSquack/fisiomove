<div class="modal-overlay" (click)="onClose()" (keydown)="onClose()"></div>
<div class="modal-content">
  <div class="modal-header">
    <h3>Resultados de búsqueda</h3>
    <button class="close-btn" (click)="onClose()" aria-label="Cerrar modal">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="modal-body">
    @if(loading){
    <div class="search-loading">
      <i class="fas fa-spinner fa-spin"></i>
      <span>Buscando pacientes</span>
    </div>
    } @if(error){
    <div class="search-error">
      <i class="fas fa-exclamation-triangle"></i>
      <span>{{ error }}</span>
    </div>
    } @if(!loading && !error && results.length){
    <ul>
      @for(patient of results; track patient.id){
      <li
        (click)="onSelect(patient)"
        (keydown)="onSelect(patient)"
        class="search-result-item"
      >
        <div class="result-main">
          <span class="result-name">{{ patient.full_name }}</span>
          <span class="result-email">{{ patient.email }}</span>
        </div>
        <div class="result-details">
          <span>{{ patient.dni }}</span>
          <span>{{ formatDate(patient.birth_date || "") }}</span>
          <span>{{ getGenderLabel(patient.gender || "") }}</span>
        </div>
      </li>
      }
    </ul>
    } @if(!loading && !error && results.length == 0){
    <div class="search-no-results">
      <i class="fas fa-search"></i>
      <span>No se encontraron pacientes</span>
      <small>Intenta con otro término de búsqueda</small>
    </div>
    }
  </div>
</div>
