<!-- Icono de búsqueda -->
<button class="search-icon-btn" (click)="openModal()" aria-label="Buscar">
  <svg
    class="search-icon"
    fill="none"
    viewBox="0 0 24 24"
    stroke="currentColor"
    width="24"
    height="24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"
    />
  </svg>
</button>

<!-- Modal de búsqueda -->
@if (showModal()) {
<div
  class="search-modal-overlay"
  (click)="closeModal()"
  (keydown)="closeModal()"
>
  <div
    class="search-modal"
    (click)="$event.stopPropagation()"
    (keydown)="$event.stopPropagation()"
  >
    <div class="search-modal-header">
      <input
        type="text"
        class="search-input"
        placeholder="Buscar..."
        [value]="searchQuery()"
        (input)="onSearchChange($event)"
        autofocus
      />
      <button class="close-btn" (click)="closeModal()" aria-label="Cerrar">
        <svg
          width="20"
          height="20"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>
    <div class="search-modal-body">
      @if (searchLoading()) {
      <div class="search-loading">
        <i class="fas fa-spinner fa-spin"></i> Buscando pacientes...
      </div>
      } @if (searchError()) {
      <div class="search-error">
        <i class="fas fa-exclamation-triangle"></i> {{ searchError() }}
      </div>
      } @if (!searchQuery() && !searchLoading() && !searchError()) {
      <p>Escribe para buscar...</p>
      } @if (searchQuery() && !searchLoading() && !searchError()) { @if
      (searchResults().length === 0) {
      <p>No se encontraron pacientes.</p>
      } @if (searchResults().length > 0) {
      <ul class="search-results-list">
        @for (patient of searchResults(); track patient.id) {
        <li class="search-result-item">
          <span class="result-name">{{
            patient.full_name || "Sin nombre"
          }}</span>
          <span class="result-email">{{ patient.email || "Sin email" }}</span>
        </li>
        }
      </ul>
      } }
    </div>
  </div>
</div>
}
